define(["jquery","core/modal_factory","core/str","core/modal_events","core/templates","core/ajax"],function(a,i,o,r,s,e){return{init:function(){var n=a("[data-key=icon_picker]"),t=o.get_string("iconselection","local_dboard");fetchMap=e.call([{methodname:"core_output_load_fontawesome_icon_map",args:[]}],!0,!1)[0],fetchMap.then(function(o){var e=[],c=[];o.forEach(function(o){-1===c.indexOf(o.to)&&s.renderPix(o.pix,o.component,o.component+"/"+o.pix).then(function(o){e.push(o)}),c.push(o.to)}),i.create({title:t,body:s.render("local_dboard/icon_picker_modal",{icons:e}),type:"SAVE_CANCEL"},n).then(function(o){o.setLarge(),o.attachToDOM(),a(".modal-body").find(".icon").on("click",function(){a(".choosed-icon").removeClass("choosed-icon"),a(this).addClass("choosed-icon")}),o.getRoot().on(r.save,function(o){var e=a(".choosed-icon").attr("title"),c=a(".choosed-icon").clone();a(".selected_icon").replaceWith(c),c.addClass("selected_icon"),c.removeClass("choosed-icon"),a('[name="icon"]').val(e)})})})}}});