{"version":3,"file":"icon_picker.min.js","sources":["../src/icon_picker.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\ndefine([\n  \"jquery\",\n  \"core/modal_factory\",\n  \"core/str\",\n  \"core/modal_events\",\n  \"core/templates\",\n  \"core/ajax\"\n], function (\n  $,\n  ModalFactory,\n  Str,\n  ModalEvents,\n  Templates,\n  Ajax\n) {\n  return {\n    init: function () {\n      var icon_pickerlink = $(\"[data-key=icon_picker]\");\n      var title = Str.get_string(\"iconselection\", \"local_dboard\");\n      var fetchMap = '';\n      fetchMap = Ajax.call([\n        {\n          methodname: \"core_output_load_fontawesome_icon_map\",\n          args: [],\n        },\n      ], true, false)[0];\n\n      fetchMap.then(function (map) {\n        var iconArray = [];\n        var toarray = [];\n        map.forEach(function (value) {\n          if (toarray.indexOf(value.to) === -1) {\n            Templates.renderPix(\n              value.pix,\n              value.component,\n              value.component + \"/\" + value.pix\n            ).then(function (result) {\n              iconArray.push(result);\n            });\n          }\n          toarray.push(value.to);\n        });\n\n        ModalFactory.create(\n          {\n            title: title,\n            body: Templates.render(\"local_dboard/icon_picker_modal\", {\n              icons: iconArray,\n            }),\n            type: \"SAVE_CANCEL\",\n          },\n          icon_pickerlink\n        ).then(function (modal) {\n          modal.setLarge();\n          modal.attachToDOM();\n          var modalBody = $(\".modal-body\");\n          var icons = modalBody.find(\".icon\");\n          icons.on(\"click\", function () {\n            $(\".choosed-icon\").removeClass(\"choosed-icon\");\n            $(this).addClass(\"choosed-icon\");\n          });\n\n          modal.getRoot().on(ModalEvents.save, function () {\n            var selectedname = $(\".choosed-icon\").attr(\"title\");\n            var clone = $(\".choosed-icon\").clone();\n            $(\".selected_icon\").replaceWith(clone);\n            clone.addClass(\"selected_icon\");\n            clone.removeClass(\"choosed-icon\");\n\n            $('[name=\"icon\"]').val(selectedname);\n          });\n        });\n      });\n    },\n  };\n});\n"],"names":["define","$","ModalFactory","Str","ModalEvents","Templates","Ajax","init","icon_pickerlink","title","get_string","call","methodname","args","then","map","iconArray","toarray","forEach","value","indexOf","to","renderPix","pix","component","result","push","create","body","render","icons","type","modal","setLarge","attachToDOM","find","on","removeClass","this","addClass","getRoot","save","selectedname","attr","clone","replaceWith","val"],"mappings":"AAeAA,kCAAO,CACL,SACA,qBACA,WACA,oBACA,iBACA,cACC,SACDC,EACAC,aACAC,IACAC,YACAC,UACAC,YAEO,CACLC,KAAM,eACAC,gBAAkBP,EAAE,0BACpBQ,MAAQN,IAAIO,WAAW,gBAAiB,gBAEjCJ,KAAKK,KAAK,CACnB,CACEC,WAAY,wCACZC,KAAM,MAEP,GAAM,GAAO,GAEPC,MAAK,SAAUC,SAClBC,UAAY,GACZC,QAAU,GACdF,IAAIG,SAAQ,SAAUC,QACe,IAA/BF,QAAQG,QAAQD,MAAME,KACxBhB,UAAUiB,UACRH,MAAMI,IACNJ,MAAMK,UACNL,MAAMK,UAAY,IAAML,MAAMI,KAC9BT,MAAK,SAAUW,QACfT,UAAUU,KAAKD,WAGnBR,QAAQS,KAAKP,MAAME,OAGrBnB,aAAayB,OACX,CACElB,MAAOA,MACPmB,KAAMvB,UAAUwB,OAAO,iCAAkC,CACvDC,MAAOd,YAETe,KAAM,eAERvB,iBACAM,MAAK,SAAUkB,OACfA,MAAMC,WACND,MAAME,cACUjC,EAAE,eACIkC,KAAK,SACrBC,GAAG,SAAS,WAChBnC,EAAE,iBAAiBoC,YAAY,gBAC/BpC,EAAEqC,MAAMC,SAAS,mBAGnBP,MAAMQ,UAAUJ,GAAGhC,YAAYqC,MAAM,eAC/BC,aAAezC,EAAE,iBAAiB0C,KAAK,SACvCC,MAAQ3C,EAAE,iBAAiB2C,QAC/B3C,EAAE,kBAAkB4C,YAAYD,OAChCA,MAAML,SAAS,iBACfK,MAAMP,YAAY,gBAElBpC,EAAE,iBAAiB6C,IAAIJ"}